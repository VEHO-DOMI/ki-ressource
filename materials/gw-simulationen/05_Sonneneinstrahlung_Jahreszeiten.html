<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sonneneinstrahlung & Jahreszeiten</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0a0a1a 0%, #1a1000 50%, #2a1800 100%);
            color: #e0e0e0;
            overflow: hidden;
            height: 100vh;
        }

        .container {
            padding: 12px;
            height: 100vh;
            display: grid;
            grid-template-columns: 1fr 280px;
            gap: 12px;
        }

        .canvas-section {
            display: grid;
            grid-template-rows: 1fr 1fr;
            gap: 12px;
            height: calc(100vh - 70px);
            overflow: hidden;
        }

        canvas {
            background: rgba(10, 10, 26, 0.6);
            border-radius: 8px;
            border: 1px solid rgba(255, 200, 100, 0.15);
            display: block;
            width: 100%;
            height: 100%;
        }

        .controls-panel {
            background: rgba(26, 16, 0, 0.7);
            border: 1px solid rgba(255, 200, 100, 0.15);
            border-radius: 8px;
            padding: 16px;
            overflow-y: auto;
            max-width: 280px;
            height: calc(100vh - 70px);
        }

        .controls-panel h2 {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 16px;
            color: #ffd966;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .control-group {
            margin-bottom: 18px;
        }

        .control-group label {
            display: block;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #ffb366;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .control-group input[type="range"] {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: rgba(255, 200, 100, 0.1);
            outline: none;
            -webkit-appearance: none;
            appearance: none;
            cursor: pointer;
        }

        .control-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ffd966, #ffb366);
            cursor: pointer;
            box-shadow: 0 0 8px rgba(255, 200, 100, 0.5);
        }

        .control-group input[type="range"]::-moz-range-thumb {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ffd966, #ffb366);
            cursor: pointer;
            border: none;
            box-shadow: 0 0 8px rgba(255, 200, 100, 0.5);
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            font-size: 11px;
            color: #b0a080;
            margin-top: 6px;
        }

        .preset-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 6px;
            margin-top: 8px;
        }

        .preset-btn {
            padding: 8px 10px;
            font-size: 10px;
            font-weight: 600;
            background: rgba(255, 200, 100, 0.1);
            border: 1px solid rgba(255, 200, 100, 0.2);
            border-radius: 4px;
            color: #ffb366;
            cursor: pointer;
            transition: all 0.2s ease;
            text-transform: uppercase;
            letter-spacing: 0.2px;
        }

        .preset-btn:hover {
            background: rgba(255, 200, 100, 0.2);
            border-color: rgba(255, 200, 100, 0.4);
            box-shadow: 0 0 8px rgba(255, 200, 100, 0.2);
        }

        .preset-btn:active {
            background: rgba(255, 200, 100, 0.3);
            transform: scale(0.98);
        }

        .toggle-group {
            display: flex;
            gap: 6px;
        }

        .toggle-btn {
            flex: 1;
            padding: 10px;
            font-size: 11px;
            font-weight: 600;
            background: rgba(255, 200, 100, 0.1);
            border: 1px solid rgba(255, 200, 100, 0.2);
            border-radius: 4px;
            color: #ffb366;
            cursor: pointer;
            transition: all 0.2s ease;
            text-transform: uppercase;
            letter-spacing: 0.2px;
        }

        .toggle-btn.active {
            background: rgba(255, 200, 100, 0.3);
            border-color: rgba(255, 200, 100, 0.5);
            color: #ffd966;
            box-shadow: 0 0 12px rgba(255, 200, 100, 0.3);
        }

        .toggle-btn:hover {
            background: rgba(255, 200, 100, 0.15);
            border-color: rgba(255, 200, 100, 0.3);
        }

        .info-panel {
            background: rgba(255, 200, 100, 0.05);
            border: 1px solid rgba(255, 200, 100, 0.15);
            border-radius: 6px;
            padding: 12px;
            margin-top: 16px;
            font-size: 12px;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 6px 0;
            border-bottom: 1px solid rgba(255, 200, 100, 0.1);
        }

        .info-row:last-child {
            border-bottom: none;
        }

        .info-label {
            color: #b0a080;
            font-weight: 600;
        }

        .info-value {
            color: #ffd966;
            font-weight: 700;
        }

        .season-indicator {
            padding: 8px;
            background: rgba(255, 200, 100, 0.1);
            border-left: 3px solid #ffd966;
            border-radius: 2px;
            margin-top: 8px;
            font-size: 11px;
            color: #ffd966;
            font-weight: 600;
        }

        .controls-panel::-webkit-scrollbar {
            width: 6px;
        }

        .controls-panel::-webkit-scrollbar-track {
            background: rgba(255, 200, 100, 0.05);
            border-radius: 3px;
        }

        .controls-panel::-webkit-scrollbar-thumb {
            background: rgba(255, 200, 100, 0.2);
            border-radius: 3px;
        }

        .controls-panel::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 200, 100, 0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="canvas-section">
            <canvas id="orbitalCanvas"></canvas>
            <canvas id="sunAngleCanvas"></canvas>
        </div>

        <div class="controls-panel">
            <h2>Sonneneinstrahlung</h2>

            <div class="control-group">
                <label for="monthSlider">Monat</label>
                <input type="range" id="monthSlider" min="0" max="365" value="0">
                <div class="slider-label">
                    <span id="dateLabel">1. Januar</span>
                </div>
            </div>

            <div class="control-group">
                <label for="latSlider">Breitengrad</label>
                <input type="range" id="latSlider" min="-90" max="90" value="48">
                <div class="slider-label">
                    <span>-90°S</span>
                    <span id="latLabel">48°N</span>
                    <span>90°N</span>
                </div>
                <div class="preset-buttons">
                    <button class="preset-btn" data-lat="90">Nordpol</button>
                    <button class="preset-btn" data-lat="48">Wien</button>
                    <button class="preset-btn" data-lat="0">Äquator</button>
                    <button class="preset-btn" data-lat="-90">Südpol</button>
                    <button class="preset-btn" data-lat="23.44">Wendekreis N</button>
                    <button class="preset-btn" data-lat="-23.44">Wendekreis S</button>
                </div>
            </div>

            <div class="control-group">
                <div class="toggle-group">
                    <button class="toggle-btn active" id="terminatorToggle">Tag-Nacht-Grenze</button>
                    <button class="toggle-btn active" id="raysToggle">Sonnenstrahlen</button>
                </div>
            </div>

            <div class="info-panel">
                <div class="info-row">
                    <span class="info-label">Datum</span>
                    <span class="info-value" id="infoDate">1. Jan</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Deklination</span>
                    <span class="info-value" id="infoDeclination">0.0°</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Sonnenhöhe</span>
                    <span class="info-value" id="infoElevation">42.0°</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Tageslänge</span>
                    <span class="info-value" id="infoDayLength">12.0 h</span>
                </div>
                <div class="season-indicator" id="seasonIndicator">Frühling</div>
            </div>
        </div>
    </div>

    <script>
        const ECLIPTIC_TILT = 23.44;
        const MONTHS = ["Januar", "Februar", "März", "April", "Mai", "Juni", "Juli", "August", "September", "Oktober", "November", "Dezember"];
        const MONTH_DAYS = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
        const SEASON_NAMES_NORTH = ["Winter", "Frühling", "Sommer", "Herbst"];
        const SEASON_NAMES_SOUTH = ["Sommer", "Herbst", "Winter", "Frühling"];

        let state = {
            dayOfYear: 0,
            latitude: 48,
            showTerminator: true,
            showRays: true,
            declination: 0,
            elevation: 0,
            dayLength: 12
        };

        const orbitalCanvas = document.getElementById("orbitalCanvas");
        const sunAngleCanvas = document.getElementById("sunAngleCanvas");
        const monthSlider = document.getElementById("monthSlider");
        const latSlider = document.getElementById("latSlider");
        const dateLabel = document.getElementById("dateLabel");
        const latLabel = document.getElementById("latLabel");
        const terminatorToggle = document.getElementById("terminatorToggle");
        const raysToggle = document.getElementById("raysToggle");
        const infoDate = document.getElementById("infoDate");
        const infoDeclination = document.getElementById("infoDeclination");
        const infoElevation = document.getElementById("infoElevation");
        const infoDayLength = document.getElementById("infoDayLength");
        const seasonIndicator = document.getElementById("seasonIndicator");

        const orbitalCtx = orbitalCanvas.getContext("2d");
        const sunAngleCtx = sunAngleCanvas.getContext("2d");

        function calculateDeclination(dayOfYear) {
            const angle = (360 / 365) * (dayOfYear - 81);
            return 23.44 * Math.sin((angle * Math.PI) / 180);
        }

        function calculateSolarElevation(latitude, declination) {
            const lat = latitude;
            const decl = declination;
            const elevationRad = Math.asin(
                Math.sin((lat * Math.PI) / 180) * Math.sin((decl * Math.PI) / 180) +
                Math.cos((lat * Math.PI) / 180) * Math.cos((decl * Math.PI) / 180)
            );
            return (elevationRad * 180) / Math.PI;
        }

        function calculateDayLength(latitude, declination) {
            const lat = (latitude * Math.PI) / 180;
            const decl = (declination * Math.PI) / 180;
            const cosH = -Math.tan(lat) * Math.tan(decl);
            let hourAngle;
            if (cosH >= 1) {
                hourAngle = 0;
            } else if (cosH <= -1) {
                hourAngle = Math.PI;
            } else {
                hourAngle = Math.acos(cosH);
            }
            return (2 * hourAngle * 180) / (Math.PI * 15);
        }

        function getDateFromDayOfYear(dayOfYear) {
            let days = dayOfYear;
            for (let month = 0; month < 12; month++) {
                if (days < MONTH_DAYS[month]) {
                    return `${days + 1}. ${MONTHS[month]}`;
                }
                days -= MONTH_DAYS[month];
            }
            return "31. Dezember";
        }

        function getSeason(dayOfYear, isNorthernHemisphere) {
            const seasons = isNorthernHemisphere ? SEASON_NAMES_NORTH : SEASON_NAMES_SOUTH;
            if (dayOfYear < 80) return seasons[0];
            if (dayOfYear < 172) return seasons[1];
            if (dayOfYear < 265) return seasons[2];
            if (dayOfYear < 355) return seasons[3];
            return seasons[0];
        }

        function resizeCanvas(canvas) {
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * window.devicePixelRatio;
            canvas.height = rect.height * window.devicePixelRatio;
            const ctx = canvas.getContext("2d");
            ctx.scale(window.devicePixelRatio, window.devicePixelRatio);
            return rect;
        }

        function drawOrbitalView() {
            const rect = resizeCanvas(orbitalCanvas);
            orbitalCtx.clearRect(0, 0, rect.width, rect.height);

            const centerX = rect.width / 2;
            const centerY = rect.height / 2;
            const orbitRadius = Math.min(rect.width, rect.height) * 0.35;

            orbitalCtx.strokeStyle = "rgba(255, 200, 100, 0.05)";
            orbitalCtx.lineWidth = 1;
            for (let i = 0; i < 5; i++) {
                const r = (orbitRadius * (i + 1)) / 5;
                orbitalCtx.beginPath();
                orbitalCtx.arc(centerX, centerY, r, 0, Math.PI * 2);
                orbitalCtx.stroke();
            }

            orbitalCtx.strokeStyle = "rgba(255, 200, 100, 0.3)";
            orbitalCtx.lineWidth = 2;
            orbitalCtx.setLineDash([5, 5]);
            orbitalCtx.beginPath();
            orbitalCtx.ellipse(centerX, centerY, orbitRadius, orbitRadius * 0.97, 0, 0, Math.PI * 2);
            orbitalCtx.stroke();
            orbitalCtx.setLineDash([]);

            const sunGradient = orbitalCtx.createRadialGradient(
                centerX, centerY, 0,
                centerX, centerY, 20
            );
            sunGradient.addColorStop(0, "rgba(255, 220, 100, 1)");
            sunGradient.addColorStop(0.4, "rgba(255, 200, 0, 0.6)");
            sunGradient.addColorStop(1, "rgba(255, 100, 0, 0)");
            orbitalCtx.fillStyle = sunGradient;
            orbitalCtx.beginPath();
            orbitalCtx.arc(centerX, centerY, 20, 0, Math.PI * 2);
            orbitalCtx.fill();

            orbitalCtx.fillStyle = "#ffd966";
            orbitalCtx.beginPath();
            orbitalCtx.arc(centerX, centerY, 10, 0, Math.PI * 2);
            orbitalCtx.fill();

            const angle = (state.dayOfYear / 365) * Math.PI * 2 - Math.PI / 2;
            const earthX = centerX + orbitRadius * Math.cos(angle);
            const earthY = centerY + orbitRadius * Math.sin(angle);

            const seasonPositions = [
                { angle: -Math.PI / 2, label: "Sommersonnenwende\n21.6.", pos: "bottom" },
                { angle: 0, label: "Wintersonnenwende\n21.12.", pos: "right" },
                { angle: Math.PI / 2, label: "Herbst-Tagundnachtgleiche\n23.9.", pos: "top" },
                { angle: Math.PI, label: "Frühlings-Tagundnachtgleiche\n21.3.", pos: "left" }
            ];

            seasonPositions.forEach(season => {
                const x = centerX + (orbitRadius + 40) * Math.cos(season.angle);
                const y = centerY + (orbitRadius + 40) * Math.sin(season.angle);
                orbitalCtx.fillStyle = "rgba(255, 200, 100, 0.4)";
                orbitalCtx.font = "11px Inter";
                orbitalCtx.textAlign = "center";
                orbitalCtx.textBaseline = "middle";
                orbitalCtx.fillText(season.label, x, y);
            });

            const earthGradient = orbitalCtx.createRadialGradient(
                earthX - 3, earthY - 3, 0,
                earthX, earthY, 8
            );
            earthGradient.addColorStop(0, "#6ba3d9");
            earthGradient.addColorStop(1, "#1a5a7f");
            orbitalCtx.fillStyle = earthGradient;
            orbitalCtx.beginPath();
            orbitalCtx.arc(earthX, earthY, 8, 0, Math.PI * 2);
            orbitalCtx.fill();

            orbitalCtx.strokeStyle = "#ffd966";
            orbitalCtx.lineWidth = 2;
            orbitalCtx.beginPath();
            orbitalCtx.moveTo(earthX, earthY - 12);
            orbitalCtx.lineTo(earthX, earthY + 12);
            orbitalCtx.stroke();

            orbitalCtx.fillStyle = "#ffd966";
            orbitalCtx.font = "bold 10px Inter";
            orbitalCtx.textAlign = "left";
            orbitalCtx.textBaseline = "middle";
            orbitalCtx.fillText("N", earthX + 15, earthY - 12);

            if (state.showTerminator) {
                const sunDeclination = state.declination;
                const terminatorX = earthX;
                const terminatorRadius = 8;
                const tiltAngle = (sunDeclination * Math.PI) / 180;

                orbitalCtx.strokeStyle = "rgba(255, 150, 0, 0.6)";
                orbitalCtx.lineWidth = 2;
                orbitalCtx.beginPath();
                for (let i = -Math.PI / 2; i <= Math.PI / 2; i += 0.05) {
                    const x = terminatorX + terminatorRadius * Math.cos(i);
                    const y = earthY + terminatorRadius * Math.sin(i) * Math.cos(tiltAngle);
                    if (i === -Math.PI / 2) {
                        orbitalCtx.moveTo(x, y);
                    } else {
                        orbitalCtx.lineTo(x, y);
                    }
                }
                orbitalCtx.stroke();
            }

            const arrowAngle = angle + 0.3;
            const arrowX = centerX + (orbitRadius - 15) * Math.cos(arrowAngle);
            const arrowY = centerY + (orbitRadius - 15) * Math.sin(arrowAngle);
            orbitalCtx.fillStyle = "rgba(255, 200, 100, 0.5)";
            orbitalCtx.beginPath();
            orbitalCtx.moveTo(arrowX, arrowY);
            orbitalCtx.lineTo(
                arrowX - 4 * Math.cos(arrowAngle - 0.3),
                arrowY - 4 * Math.sin(arrowAngle - 0.3)
            );
            orbitalCtx.lineTo(
                arrowX - 4 * Math.cos(arrowAngle + 0.3),
                arrowY - 4 * Math.sin(arrowAngle + 0.3)
            );
            orbitalCtx.closePath();
            orbitalCtx.fill();
        }

        function drawSunAngleDiagram() {
            const rect = resizeCanvas(sunAngleCanvas);
            sunAngleCtx.clearRect(0, 0, rect.width, rect.height);

            const padding = 40;
            const groundY = rect.height - padding;
            const diagWidth = rect.width - 2 * padding;
            const maxHeight = rect.height - 2 * padding;

            sunAngleCtx.strokeStyle = "rgba(200, 150, 100, 0.5)";
            sunAngleCtx.lineWidth = 3;
            sunAngleCtx.beginPath();
            sunAngleCtx.moveTo(padding, groundY);
            sunAngleCtx.lineTo(rect.width - padding, groundY);
            sunAngleCtx.stroke();

            sunAngleCtx.strokeStyle = "rgba(255, 200, 100, 0.2)";
            sunAngleCtx.lineWidth = 1;
            sunAngleCtx.beginPath();
            sunAngleCtx.arc(
                rect.width / 2,
                groundY,
                diagWidth / 2,
                Math.PI,
                Math.PI * 2
            );
            sunAngleCtx.stroke();

            sunAngleCtx.strokeStyle = "rgba(255, 200, 100, 0.1)";
            sunAngleCtx.lineWidth = 1;
            for (let i = 10; i <= 80; i += 10) {
                const angle = (i * Math.PI) / 180;
                const x = rect.width / 2 + (diagWidth / 2) * Math.cos(angle);
                const y = groundY - (diagWidth / 2) * Math.sin(angle);
                sunAngleCtx.beginPath();
                sunAngleCtx.arc(x, y, 2, 0, Math.PI * 2);
                sunAngleCtx.stroke();
                if (i % 30 === 0) {
                    sunAngleCtx.fillStyle = "rgba(255, 200, 100, 0.3)";
                    sunAngleCtx.font = "11px Inter";
                    sunAngleCtx.textAlign = "center";
                    sunAngleCtx.textBaseline = "bottom";
                    sunAngleCtx.fillText(i + "°", x, y - 8);
                }
            }

            const elevation = Math.max(0, Math.min(90, state.elevation));
            const elevationRad = (elevation * Math.PI) / 180;
            const sunX = rect.width / 2 + (diagWidth / 2) * Math.cos(elevationRad);
            const sunY = groundY - (diagWidth / 2) * Math.sin(elevationRad);

            if (state.showRays) {
                sunAngleCtx.strokeStyle = "rgba(255, 200, 100, 0.3)";
                sunAngleCtx.lineWidth = 1;
                for (let i = -3; i <= 3; i++) {
                    const rayX = sunX + i * 4;
                    sunAngleCtx.beginPath();
                    sunAngleCtx.moveTo(rayX, sunY);
                    const groundX = rect.width / 2 + Math.tan(elevationRad) * (groundY - sunY);
                    sunAngleCtx.lineTo(groundX, groundY);
                    sunAngleCtx.stroke();
                }
            }

            const sunGradient = sunAngleCtx.createRadialGradient(
                sunX - 2, sunY - 2, 0,
                sunX, sunY, 12
            );
            sunGradient.addColorStop(0, "rgba(255, 220, 100, 1)");
            sunGradient.addColorStop(0.5, "rgba(255, 200, 0, 0.7)");
            sunGradient.addColorStop(1, "rgba(255, 100, 0, 0)");
            sunAngleCtx.fillStyle = sunGradient;
            sunAngleCtx.beginPath();
            sunAngleCtx.arc(sunX, sunY, 12, 0, Math.PI * 2);
            sunAngleCtx.fill();

            sunAngleCtx.fillStyle = "#ffd966";
            sunAngleCtx.beginPath();
            sunAngleCtx.arc(sunX, sunY, 6, 0, Math.PI * 2);
            sunAngleCtx.fill();

            sunAngleCtx.strokeStyle = "rgba(255, 200, 100, 0.6)";
            sunAngleCtx.lineWidth = 2;
            sunAngleCtx.beginPath();
            sunAngleCtx.arc(
                rect.width / 2,
                groundY,
                40,
                Math.PI,
                Math.PI + elevationRad
            );
            sunAngleCtx.stroke();

            sunAngleCtx.fillStyle = "#ffd966";
            sunAngleCtx.font = "bold 16px Inter";
            sunAngleCtx.textAlign = "center";
            sunAngleCtx.textBaseline = "middle";
            sunAngleCtx.fillText(elevation.toFixed(1) + "°", rect.width / 2 + 60, groundY - 30);

            const hourAngle = Math.acos(
                -Math.tan((state.latitude * Math.PI) / 180) *
                Math.tan((state.declination * Math.PI) / 180)
            );
            sunAngleCtx.strokeStyle = "rgba(150, 200, 255, 0.4)";
            sunAngleCtx.lineWidth = 3;
            sunAngleCtx.beginPath();
            sunAngleCtx.arc(
                rect.width / 2,
                groundY,
                diagWidth / 2,
                Math.PI - hourAngle,
                Math.PI + hourAngle
            );
            sunAngleCtx.stroke();

            sunAngleCtx.fillStyle = "rgba(255, 200, 100, 0.7)";
            sunAngleCtx.font = "12px Inter";
            sunAngleCtx.textAlign = "left";
            sunAngleCtx.textBaseline = "bottom";
            sunAngleCtx.fillText("Sonnenhöhe Diagramm", padding, padding - 5);

            sunAngleCtx.fillStyle = "rgba(150, 200, 255, 0.6)";
            sunAngleCtx.font = "11px Inter";
            sunAngleCtx.textAlign = "center";
            sunAngleCtx.fillText(
                `Tageslänge: ${state.dayLength.toFixed(1)} Stunden`,
                rect.width / 2,
                padding + 15
            );
        }

        function updateState() {
            state.declination = calculateDeclination(state.dayOfYear);
            state.elevation = calculateSolarElevation(state.latitude, state.declination);
            state.dayLength = calculateDayLength(state.latitude, state.declination);

            dateLabel.textContent = getDateFromDayOfYear(state.dayOfYear);
            latLabel.textContent = state.latitude >= 0 ? state.latitude.toFixed(1) + "°N" : Math.abs(state.latitude).toFixed(1) + "°S";

            infoDate.textContent = getDateFromDayOfYear(state.dayOfYear);
            infoDeclination.textContent = state.declination.toFixed(1) + "°";
            infoElevation.textContent = state.elevation.toFixed(1) + "°";
            infoDayLength.textContent = state.dayLength.toFixed(1) + " h";

            const isNorthernHemisphere = state.latitude >= 0;
            seasonIndicator.textContent = getSeason(state.dayOfYear, isNorthernHemisphere);

            drawOrbitalView();
            drawSunAngleDiagram();
        }

        monthSlider.addEventListener("input", (e) => {
            state.dayOfYear = parseInt(e.target.value);
            updateState();
        });

        latSlider.addEventListener("input", (e) => {
            state.latitude = parseInt(e.target.value);
            updateState();
        });

        terminatorToggle.addEventListener("click", () => {
            state.showTerminator = !state.showTerminator;
            terminatorToggle.classList.toggle("active");
            drawOrbitalView();
        });

        raysToggle.addEventListener("click", () => {
            state.showRays = !state.showRays;
            raysToggle.classList.toggle("active");
            drawSunAngleDiagram();
        });

        document.querySelectorAll(".preset-btn").forEach(btn => {
            btn.addEventListener("click", () => {
                state.latitude = parseInt(btn.dataset.lat);
                latSlider.value = state.latitude;
                updateState();
            });
        });

        window.addEventListener("resize", updateState);

        updateState();
    </script>
</body>
</html>
