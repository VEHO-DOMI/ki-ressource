<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Synapse - Signal√ºbertragung</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            padding: 20px;
            color: #fff;
        }
        .container { max-width: 100%; margin: 0 auto; padding: 0 10px; }
        h1 { text-align: center; margin-bottom: 10px; font-size: 1.8em; color: #4fc3f7; }
        .subtitle { text-align: center; color: #90a4ae; margin-bottom: 20px; }
        .simulation-area {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        canvas {
            display: block;
            margin: 0 auto;
            background: radial-gradient(ellipse at center, #0a1628 0%, #050a14 100%);
            border-radius: 10px;
            border: 2px solid #4fc3f7;
            max-width: 100%;
            height: auto;
        }
        .step-display {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .step-item {
            padding: 10px 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
            font-size: 0.85em;
            transition: all 0.3s;
        }
        .step-item.active {
            background: linear-gradient(135deg, #9b59b6, #3498db);
            font-weight: bold;
        }
        .step-item.completed { background: rgba(46, 204, 113, 0.3); }
        .info-display {
            text-align: center;
            padding: 20px;
            background: rgba(0,0,0,0.2);
            border-radius: 15px;
            margin: 15px 0;
        }
        .info-title { font-size: 1.4em; color: #4fc3f7; margin-bottom: 10px; }
        .info-desc { color: #b0bec5; line-height: 1.6; max-width: 700px; margin: 0 auto; }
        .neurotransmitter-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        .nt-btn {
            padding: 10px 20px;
            border: 2px solid;
            background: transparent;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.2s;
        }
        .nt-btn.acetylcholin { border-color: #2ecc71; color: #2ecc71; }
        .nt-btn.dopamin { border-color: #f1c40f; color: #f1c40f; }
        .nt-btn.serotonin { border-color: #9b59b6; color: #9b59b6; }
        .nt-btn.active { color: #1a1a2e; }
        .nt-btn.active.acetylcholin { background: #2ecc71; }
        .nt-btn.active.dopamin { background: #f1c40f; }
        .nt-btn.active.serotonin { background: #9b59b6; }
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
        }
        .control-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1em;
            transition: all 0.2s;
        }
        .control-btn:hover { transform: translateY(-2px); }
        .control-btn.fire { background: linear-gradient(135deg, #e74c3c, #c0392b); color: white; }
        .control-btn.reset { background: linear-gradient(135deg, #3498db, #2980b9); color: white; }
        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.85em; }
        .legend-dot { width: 16px; height: 16px; border-radius: 50%; }
        .potential-display {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 15px 0;
        }
        .potential-box {
            padding: 15px 25px;
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            text-align: center;
        }
        .potential-value { font-size: 1.8em; font-weight: bold; }
        .potential-label { font-size: 0.85em; color: #90a4ae; }
        .info-box {
            background: rgba(79, 195, 247, 0.1);
            border-left: 4px solid #4fc3f7;
            padding: 15px 20px;
            border-radius: 0 10px 10px 0;
            margin-top: 20px;
        }
        .info-box h3 { color: #4fc3f7; margin-bottom: 10px; }
        .info-box p { line-height: 1.6; color: #b0bec5; }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚ö° Synapse ‚Äì Signal√ºbertragung</h1>
        <p class="subtitle">6. Klasse Biologie ‚Äì Wie Nervenzellen kommunizieren</p>

        <div class="simulation-area">
            <div class="neurotransmitter-selector">
                <span style="color: #90a4ae;">Neurotransmitter:</span>
                <button class="nt-btn acetylcholin active" onclick="selectNT('acetylcholin')">üü¢ Acetylcholin</button>
                <button class="nt-btn dopamin" onclick="selectNT('dopamin')">üü° Dopamin</button>
                <button class="nt-btn serotonin" onclick="selectNT('serotonin')">üü£ Serotonin</button>
            </div>

            <canvas id="synapseCanvas" width="850" height="400"></canvas>

            <div class="potential-display">
                <div class="potential-box">
                    <div class="potential-value" id="presynapticPotential" style="color: #e74c3c;">-70 mV</div>
                    <div class="potential-label">Pr√§synaptisches Neuron</div>
                </div>
                <div class="potential-box">
                    <div class="potential-value" id="postsynapticPotential" style="color: #3498db;">-70 mV</div>
                    <div class="potential-label">Postsynaptisches Neuron</div>
                </div>
            </div>

            <div class="step-display">
                <div class="step-item active" data-step="0">1. Ruhezustand</div>
                <div class="step-item" data-step="1">2. Aktionspotential</div>
                <div class="step-item" data-step="2">3. Ca¬≤‚Å∫-Einstrom</div>
                <div class="step-item" data-step="3">4. Vesikel-Fusion</div>
                <div class="step-item" data-step="4">5. Transmitter</div>
                <div class="step-item" data-step="5">6. Rezeptorbindung</div>
            </div>

            <div class="info-display">
                <div class="info-title" id="stepTitle">1. Ruhezustand</div>
                <div class="info-desc" id="stepDesc">
                    Das Neuron ist im Ruhezustand. Das Membranpotential betr√§gt -70 mV.
                    Die Vesikel mit Neurotransmittern warten im synaptischen Endkn√∂pfchen.
                </div>
            </div>

            <div class="controls">
                <button class="control-btn fire" onclick="fireNeuron()">‚ö° Signal senden</button>
                <button class="control-btn reset" onclick="resetSynapse()">‚Ü∫ Zur√ºcksetzen</button>
            </div>

            <div class="legend">
                <div class="legend-item">
                    <div class="legend-dot" style="background: #f39c12;"></div>
                    <span>Vesikel</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot" style="background: #2ecc71;"></div>
                    <span>Neurotransmitter</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot" style="background: #e74c3c;"></div>
                    <span>Ca¬≤‚Å∫ Ionen</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot" style="background: #9b59b6;"></div>
                    <span>Rezeptoren</span>
                </div>
            </div>
        </div>

        <div class="info-box">
            <h3>üìö Die Synapse</h3>
            <p>Die Synapse ist die Verbindungsstelle zwischen zwei Nervenzellen. Ein elektrisches Signal (Aktionspotential)
            l√∂st die Freisetzung von <strong>Neurotransmittern</strong> aus. Diese binden an <strong>Rezeptoren</strong>
            der n√§chsten Zelle und l√∂sen dort ein neues Signal aus. Der synaptische Spalt ist nur 20-40 nm breit!</p>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('synapseCanvas');
        const ctx = canvas.getContext('2d');

        const ntColors = {
            acetylcholin: '#2ecc71',
            dopamin: '#f1c40f',
            serotonin: '#9b59b6'
        };

        let selectedNT = 'acetylcholin';
        let currentStep = 0;
        let isAnimating = false;
        let animationProgress = 0;
        let vesicles = [];
        let neurotransmitters = [];
        let calciumIons = [];

        const steps = [
            { title: '1. Ruhezustand', desc: 'Das Neuron ist im Ruhezustand. Das Membranpotential betr√§gt -70 mV. Die Vesikel mit Neurotransmittern warten im synaptischen Endkn√∂pfchen.' },
            { title: '2. Aktionspotential', desc: 'Ein Aktionspotential (+40 mV) erreicht das synaptische Endkn√∂pfchen. Die Depolarisation breitet sich entlang des Axons aus.' },
            { title: '3. Ca¬≤‚Å∫-Einstrom', desc: 'Spannungsgesteuerte Calciumkan√§le √∂ffnen sich. Ca¬≤‚Å∫-Ionen str√∂men in das Endkn√∂pfchen ein.' },
            { title: '4. Vesikel-Fusion', desc: 'Die erh√∂hte Ca¬≤‚Å∫-Konzentration bewirkt, dass Vesikel mit der pr√§synaptischen Membran verschmelzen.' },
            { title: '5. Transmitter-Freisetzung', desc: 'Neurotransmitter werden durch Exozytose in den synaptischen Spalt freigesetzt.' },
            { title: '6. Rezeptorbindung', desc: 'Neurotransmitter binden an Rezeptoren der postsynaptischen Membran. Ionenkan√§le √∂ffnen sich, ein neues Signal entsteht.' }
        ];

        // Initialize vesicles
        function initVesicles() {
            vesicles = [];
            for (let i = 0; i < 6; i++) {
                vesicles.push({
                    x: 180 + (i % 3) * 30,
                    y: 150 + Math.floor(i / 3) * 30,
                    released: false
                });
            }
        }

        function selectNT(nt) {
            selectedNT = nt;
            document.querySelectorAll('.nt-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.nt-btn.${nt}`).classList.add('active');
            resetSynapse();
        }

        function drawPresynapticNeuron() {
            // Axon
            ctx.fillStyle = currentStep >= 1 ? '#ff6b6b' : '#e74c3c';
            ctx.beginPath();
            ctx.moveTo(0, 180);
            ctx.lineTo(150, 180);
            ctx.lineTo(150, 220);
            ctx.lineTo(0, 220);
            ctx.fill();

            // Synaptic terminal (enlarged end)
            ctx.beginPath();
            ctx.arc(200, 200, 80, 0, Math.PI * 2);
            const terminalGrad = ctx.createRadialGradient(180, 180, 10, 200, 200, 80);
            terminalGrad.addColorStop(0, currentStep >= 1 ? '#ff8080' : '#ff6b6b');
            terminalGrad.addColorStop(1, currentStep >= 1 ? '#c0392b' : '#a93226');
            ctx.fillStyle = terminalGrad;
            ctx.fill();

            // Vesicles
            vesicles.forEach(v => {
                if (!v.released) {
                    ctx.beginPath();
                    ctx.arc(v.x, v.y, 12, 0, Math.PI * 2);
                    ctx.fillStyle = '#f39c12';
                    ctx.fill();
                    ctx.strokeStyle = '#e67e22';
                    ctx.lineWidth = 2;
                    ctx.stroke();

                    // NT inside vesicle
                    ctx.fillStyle = ntColors[selectedNT];
                    for (let i = 0; i < 3; i++) {
                        ctx.beginPath();
                        ctx.arc(v.x + (i - 1) * 5, v.y, 2, 0, Math.PI * 2);
                        ctx.fill();
                    }
                }
            });

            // Calcium channels
            if (currentStep >= 2) {
                ctx.fillStyle = '#3498db';
                for (let i = 0; i < 3; i++) {
                    ctx.fillRect(260, 160 + i * 25, 15, 20);
                }
            }

            // Calcium ions
            calciumIons.forEach(ion => {
                ctx.beginPath();
                ctx.arc(ion.x, ion.y, 5, 0, Math.PI * 2);
                ctx.fillStyle = '#e74c3c';
                ctx.fill();
                ctx.fillStyle = '#fff';
                ctx.font = '8px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('Ca', ion.x, ion.y + 3);
            });

            // Label
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 12px Segoe UI';
            ctx.textAlign = 'center';
            ctx.fillText('Pr√§synaptisches', 120, 260);
            ctx.fillText('Neuron', 120, 275);
        }

        function drawSynapticCleft() {
            // Synaptic cleft (gap)
            ctx.fillStyle = 'rgba(52, 152, 219, 0.2)';
            ctx.fillRect(280, 120, 60, 160);

            // Neurotransmitters in cleft
            neurotransmitters.forEach(nt => {
                ctx.beginPath();
                ctx.arc(nt.x, nt.y, 4, 0, Math.PI * 2);
                ctx.fillStyle = ntColors[selectedNT];
                ctx.fill();
            });

            // Label
            ctx.fillStyle = '#90a4ae';
            ctx.font = '10px Segoe UI';
            ctx.textAlign = 'center';
            ctx.fillText('Synaptischer', 310, 300);
            ctx.fillText('Spalt (20nm)', 310, 315);
        }

        function drawPostsynapticNeuron() {
            // Dendrite
            ctx.fillStyle = currentStep >= 5 ? '#5dade2' : '#3498db';
            ctx.beginPath();
            ctx.moveTo(340, 120);
            ctx.lineTo(850, 120);
            ctx.lineTo(850, 280);
            ctx.lineTo(340, 280);
            ctx.fill();

            // Receptors
            ctx.fillStyle = '#9b59b6';
            for (let i = 0; i < 5; i++) {
                const y = 140 + i * 25;
                ctx.beginPath();
                ctx.moveTo(340, y);
                ctx.lineTo(355, y - 10);
                ctx.lineTo(370, y);
                ctx.lineTo(355, y + 10);
                ctx.closePath();
                ctx.fill();

                // Receptor binding site
                ctx.fillStyle = currentStep >= 5 && neurotransmitters.some(nt => Math.abs(nt.y - y) < 15) ? ntColors[selectedNT] : '#7d3c98';
                ctx.beginPath();
                ctx.arc(355, y, 6, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = '#9b59b6';
            }

            // Ion channels (open when activated)
            if (currentStep >= 5) {
                ctx.fillStyle = '#2ecc71';
                ctx.font = '10px Segoe UI';
                ctx.fillText('Na‚Å∫ ‚Üí', 380, 170);
                ctx.fillText('Na‚Å∫ ‚Üí', 380, 220);
            }

            // Label
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 12px Segoe UI';
            ctx.textAlign = 'center';
            ctx.fillText('Postsynaptisches Neuron', 550, 300);
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            drawPresynapticNeuron();
            drawSynapticCleft();
            drawPostsynapticNeuron();

            // Draw action potential wave if in step 1
            if (currentStep === 1) {
                ctx.strokeStyle = '#f1c40f';
                ctx.lineWidth = 3;
                ctx.beginPath();
                for (let x = 0; x < 200; x += 5) {
                    const y = 200 + Math.sin((x + animationProgress * 100) * 0.1) * 20;
                    if (x === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                }
                ctx.stroke();
            }
        }

        function updateStepDisplay() {
            document.querySelectorAll('.step-item').forEach((item, i) => {
                item.classList.remove('active', 'completed');
                if (i < currentStep) item.classList.add('completed');
                if (i === currentStep) item.classList.add('active');
            });

            document.getElementById('stepTitle').textContent = steps[currentStep].title;
            document.getElementById('stepDesc').textContent = steps[currentStep].desc;

            // Update potential displays
            const prePotential = currentStep >= 1 ? '+40 mV' : '-70 mV';
            const postPotential = currentStep >= 5 ? '-55 mV' : '-70 mV';
            document.getElementById('presynapticPotential').textContent = prePotential;
            document.getElementById('presynapticPotential').style.color = currentStep >= 1 ? '#f1c40f' : '#e74c3c';
            document.getElementById('postsynapticPotential').textContent = postPotential;
            document.getElementById('postsynapticPotential').style.color = currentStep >= 5 ? '#2ecc71' : '#3498db';
        }

        function fireNeuron() {
            if (isAnimating) return;
            isAnimating = true;
            animateSequence();
        }

        function animateSequence() {
            if (currentStep >= 6) {
                isAnimating = false;
                return;
            }

            currentStep++;
            updateStepDisplay();

            if (currentStep === 3) {
                // Add calcium ions
                for (let i = 0; i < 8; i++) {
                    calciumIons.push({
                        x: 280,
                        y: 160 + Math.random() * 80,
                        targetX: 200 + Math.random() * 60,
                        targetY: 160 + Math.random() * 80
                    });
                }
            }

            if (currentStep === 4) {
                // Move vesicles to membrane
                vesicles.forEach((v, i) => {
                    if (i < 3) {
                        v.targetX = 260;
                        v.targetY = 150 + i * 35;
                    }
                });
            }

            if (currentStep === 5) {
                // Release neurotransmitters
                vesicles.forEach((v, i) => {
                    if (i < 3) {
                        v.released = true;
                        for (let j = 0; j < 5; j++) {
                            neurotransmitters.push({
                                x: 280,
                                y: v.y + (Math.random() - 0.5) * 20,
                                targetX: 340,
                                targetY: 140 + Math.floor(j / 2) * 25 + (i * 8)
                            });
                        }
                    }
                });
            }

            animateStep();
        }

        function animateStep() {
            animationProgress += 0.02;

            // Animate calcium ions
            calciumIons.forEach(ion => {
                ion.x += (ion.targetX - ion.x) * 0.1;
                ion.y += (ion.targetY - ion.y) * 0.1;
            });

            // Animate vesicles
            vesicles.forEach(v => {
                if (v.targetX) {
                    v.x += (v.targetX - v.x) * 0.1;
                    v.y += (v.targetY - v.y) * 0.1;
                }
            });

            // Animate neurotransmitters
            neurotransmitters.forEach(nt => {
                if (nt.targetX) {
                    nt.x += (nt.targetX - nt.x) * 0.05;
                    nt.y += (nt.targetY - nt.y) * 0.05;
                }
            });

            draw();

            if (animationProgress < 1) {
                requestAnimationFrame(animateStep);
            } else {
                animationProgress = 0;
                setTimeout(animateSequence, 800);
            }
        }

        function resetSynapse() {
            currentStep = 0;
            isAnimating = false;
            animationProgress = 0;
            neurotransmitters = [];
            calciumIons = [];
            initVesicles();
            updateStepDisplay();
            draw();
        }

        initVesicles();
        draw();
    </script>
</body>
</html>
